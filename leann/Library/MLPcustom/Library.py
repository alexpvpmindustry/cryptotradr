#region imports
from AlgorithmImports import *
#endregion
import torch
import torch.nn as nn
import numpy as np
import torch.optim as optim

### Library classes are snippets of code/classes you can reuse between projects. They are
### added to projects on compile.
###
### To import this class use the following import with your values subbed in for the {} sections:
### from {libraryProjectName} import {libraryFileName}
### 
### Example using your newly imported library from 'Library.py' like so:
###
### from {libraryProjectName} import Library
### x = Library.Add(1,1)
### print(x)
###

class MLPClassifierPyTorch(nn.Module):
    def __init__(self, input_size, num_classes=3, weights=None, biases=None):
        super(MLPClassifierPyTorch, self).__init__()
        self.fc1 = nn.Linear(input_size, 150)
        self.fc2 = nn.Linear(150, 150)
        self.fc3 = nn.Linear(150, 50)
        self.fc4 = nn.Linear(50, 10)
        self.fc5 = nn.Linear(10, 50)
        self.fc6 = nn.Linear(50, 150)
        self.fc7 = nn.Linear(150, num_classes) 
        if weights is not None and biases is not None:
            self.init_weights(weights, biases)

    def init_weights(self, weights, biases):
        layers = [self.fc1, self.fc2, self.fc3, self.fc4, self.fc5, self.fc6, self.fc7]

        for i, layer in enumerate(layers):
            layer.weight.data = torch.from_numpy(weights[i].T).float()
            layer.bias.data = torch.from_numpy(biases[i]).float()

    def forward(self, x):
        x = torch.relu(self.fc1(x))
        x = torch.relu(self.fc2(x))
        x = torch.relu(self.fc3(x))
        x = torch.relu(self.fc4(x))
        x = torch.relu(self.fc5(x))
        x = torch.relu(self.fc6(x))
        x = self.fc7(x)  # No activation here, CrossEntropyLoss will apply softmax
        return x


def loadclf2(self):
    file_name2 = self.ObjectStore.GetFilePath("3_0_5_pytorch_clf.pt")
    clf2= torch.load(file_name2)
    return clf2

def snp500_symbols():
    return ['TSLA',
 'NVDA',
 'MSFT',
 'AAPL',
 'META',
 'AMD',
 'AMZN',
 'GOOGL',
 'AVGO',
 'CRM',
 'GOOG',
 'NFLX',
 'JPM',
 'BA',
 'LLY',
 'ADBE',
 'UNH',
 'XOM',
 'DIS',
 'BAC',
 'AMAT',
 'PYPL',
 'JNJ',
 'SLB',
 'VZ',
 'KO',
 'INTC',
 'V',
 'MS',
 'HD',
 'OXY',
 'MU',
 'MA',
 'CAT',
 'CCL',
 'CVX',
 'FDX',
 'CSCO',
 'BKNG',
 'BX',
 'PG',
 'LRCX',
 'EA',
 'PEP',
 'ORCL',
 'DHR',
 'PANW',
 'ABBV',
 'F',
 'TMO',
 'QCOM',
 'COST',
 'CMCSA',
 'MRK',
 'WFC',
 'GS',
 'TTWO',
 'C',
 'NOW',
 'ISRG',
 'PFE',
 'MMM',
 'RTX',
 'COP',
 'T',
 'WMT',
 'ETSY',
 'MDLZ',
 'NKE',
 'BMY',
 'HON',
 'USB',
 'INTU',
 'TGT',
 'HUM',
 'HAL',
 'UPS',
 'CMG',
 'SBUX',
 'ELV',
 'TMUS',
 'LOW',
 'CVS',
 'ENPH',
 'TXN',
 'SCHW',
 'DAL',
 'NEE',
 'DE',
 'FCX',
 'GM',
 'HPQ',
 'MCD',
 'AMGN',
 'AAL',
 'DLTR',
 'UNP',
 'DVN',
 'LIN',
 'GE',
 'VLO',
 'ABT',
 'URI',
 'SNPS',
 'ACN',
 'PXD',
 'REGN',
 'AXP',
 'CL',
 'ADI',
 'CHTR',
 'IBM',
 'ON',
 'MAR',
 'SPGI',
 'TFC',
 'ALB',
 'ETN',
 'MCHP',
 'DHI',
 'MRO',
 'BLK',
 'MET',
 'EOG',
 'DG',
 'ODFL',
 'CSX',
 'LULU',
 'FTNT',
 'WMB',
 'NXPI',
 'PM',
 'COF',
 'LMT',
 'PAYX',
 'APA',
 'EMR',
 'VRTX',
 'O',
 'GD',
 'MO',
 'MPC',
 'LUV',
 'NOC',
 'HLT',
 'KLAC',
 'TJX',
 'AZO',
 'EXPE',
 'IQV',
 'PSX',
 'DLR',
 'IDXX',
 'TSCO',
 'MNST',
 'PH',
 'CMI',
 'FANG',
 'NEM',
 'ILMN',
 'HSY',
 'CDNS',
 'PLD',
 'ADP',
 'AMT',
 'MGM',
 'GWW',
 'PNC',
 'AEP',
 'NSC',
 'ORLY',
 'DUK',
 'WM',
 'NCLH',
 'BSX',
 'GNRC',
 'KDP',
 'ICE',
 'VMC',
 'KHC',
 'TDG',
 'EQIX',
 'GILD',
 'CB',
 'CI',
 'PGR',
 'ANET',
 'WBA',
 'BKR',
 'BIIB',
 'MCO',
 'ADSK',
 'SYK',
 'ROK',
 'CTAS',
 'MDT',
 'HCA',
 'UAL',
 'JCI',
 'ULTA',
 'RCL',
 'CSGP',
 'KEY',
 'FI',
 'KMI',
 'EL',
 'GIS',
 'MSCI',
 'ROP',
 'EBAY',
 'FIS',
 'FMC',
 'HES',
 'MPWR',
 'VRSN',
 'TRV',
 'DXCM',
 'APTV',
 'WBD',
 'ITW',
 'CCI',
 'MCK',
 'ADM',
 'PPG',
 'MMC',
 'ALL',
 'LW',
 'LVS',
 'ROST',
 'SWK',
 'CLX',
 'EQT',
 'NUE',
 'MTCH',
 'WTW',
 'PCAR',
 'FSLR',
 'SHW',
 'WELL',
 'LHX',
 'SPG',
 'MSI',
 'STZ',
 'TROW',
 'SO',
 'YUM',
 'CBRE',
 'WYNN',
 'PHM',
 'NDAQ',
 'OKE',
 'FAST',
 'ECL',
 'ZTS',
 'EXR',
 'GPN',
 'RSG',
 'BDX',
 'SYY',
 'PWR',
 'CF',
 'XEL',
 'TT',
 'APD',
 'CTRA',
 'SRE',
 'CAG',
 'CME',
 'BLDR',
 'KR',
 'KMB',
 'LEN',
 'TAP',
 'EW',
 'NTAP',
 'LYV',
 'AON',
 'IFF',
 'CFG',
 'BK',
 'AME',
 'DPZ',
 'PRU',
 'CTSH',
 'HPE',
 'DFS',
 'PCG',
 'D',
 'MKC',
 'APH',
 'VRSK',
 'EXC',
 'ALGN',
 'AFL',
 'PARA',
 'TEL',
 'POOL',
 'AIG',
 'BAX',
 'CE',
 'VTRS',
 'CTLT',
 'EFX',
 'WHR',
 'TRGP',
 'LH',
 'PSA',
 'PAYC',
 'CNC',
 'WAB',
 'DD',
 'MLM',
 'SBAC',
 'WY',
 'DRI',
 'CAH',
 'FDS',
 'RL',
 'PNR',
 'TSN',
 'STT',
 'XYL',
 'FITB',
 'KMX',
 'SWKS',
 'BBY',
 'AMP',
 'A',
 'COR',
 'CPRT',
 'SYF',
 'PODD',
 'MOH',
 'AKAM',
 'TER',
 'HWM',
 'KEYS',
 'FICO',
 'MTB',
 'CZR',
 'OMC',
 'ZION',
 'BBWI',
 'HUBB',
 'ACGL',
 'ZBH',
 'AVB',
 'MHK',
 'IEX',
 'ANSS',
 'PPL',
 'IR',
 'MAS',
 'GPC',
 'WDC',
 'BG',
 'QRVO',
 'STLD',
 'JBHT',
 'NRG',
 'MOS',
 'RMD',
 'GLW',
 'CMA',
 'MTD',
 'IT',
 'SJM',
 'CPB',
 'GRMN',
 'VICI',
 'AVY',
 'LYB',
 'BWA',
 'ETR',
 'CHD',
 'AXON',
 'K',
 'VFC',
 'AJG',
 'HBAN',
 'EXPD',
 'EPAM',
 'AWK',
 'DOV',
 'ALLE',
 'RF',
 'ED',
 'IPG',
 'ES',
 'ZBRA',
 'BRO',
 'UDR',
 'FLT',
 'AOS',
 'BEN',
 'RJF',
 'PEG',
 'HIG',
 'DGX',
 'CNP',
 'MAA',
 'UHS',
 'FTV',
 'WEC',
 'WAT',
 'J',
 'LKQ',
 'HAS',
 'TPR',
 'FFIV',
 'CMS',
 'ARE',
 'DTE',
 'BALL',
 'WST',
 'HST',
 'RHI',
 'STE',
 'CDW',
 'CHRW',
 'AEE',
 'XRAY',
 'PKG',
 'BIO',
 'IP',
 'PTC',
 'JBL',
 'HOLX',
 'INVH',
 'JNPR',
 'INCY',
 'MKTX',
 'CRL',
 'PEAK',
 'NVR',
 'CINF',
 'IRM',
 'ATO',
 'NTRS',
 'STX',
 'BR',
 'BXP',
 'HRL',
 'EQR',
 'WRK',
 'LDOS',
 'FRT',
 'PFG',
 'TYL',
 'CBOE',
 'SNA',
 'CPT',
 'TDY',
 'COO',
 'LNT',
 'JKHY',
 'HSIC',
 'WRB',
 'EMN',
 'EG',
 'FE',
 'ROL',
 'RVTY',
 'GEN',
 'DVA',
 'VTR',
 'NI',
 'IVZ',
 'REG',
 'KIM',
 'HII',
 'ESS',
 'TXT',
 'EIX',
 'AMCR',
 'AES',
 'TFX',
 'NDSN',
 'TECH',
 'EVRG',
 'GL',
 'PNW',
 'NWSA',
 'L',
 'TRMB',
 'AIZ',
 'NWS']
